{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{NativeWindStyleSheet as _NativeWindStyleSheet}from\"nativewind\";import{StyledComponent as _StyledComponent}from\"nativewind\";import{SafeAreaProvider}from'react-native-safe-area-context';import Register from\"./src/frontend/screens/auth/login\";import{StatusBar}from'expo-status-bar';import LoadingOverlay from\"./src/frontend/components/LoadingOverlay\";import useProfile from\"./src/hooks/useProfile\";import{UserContext}from\"./src/context/user\";import theme from\"./src/theme/nativebase\";import{NativeBaseProvider}from\"native-base\";import Images from\"./src/theme/images\";import ImageBackground from\"react-native-web/dist/exports/ImageBackground\";import MainNavigationStack from\"./src/frontend/navigation/main\";import SetupScreen from\"./src/frontend/screens/auth/setup\";import{useToast}from'native-base';import ToastDialog from\"./src/frontend/components/global/toast\";import UserController from\"./src/controller/user\";import useCurrentLocation from\"./src/hooks/useCurrentLocation\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function App(){var toast=useToast();var _useProfile=useProfile(function(error){toast.show({render:function render(){return _jsx(ToastDialog,{message:error});}});}),authUser=_useProfile.user,profile=_useProfile.userProfile,setProfile=_useProfile.setUserProfile,authStatus=_useProfile.status,profileLoading=_useProfile.profileLoading;var updateGeoLocation=function(){var _ref=_asyncToGenerator(function*(location){var _location$coords;if(!profile)return;var data={lat:location.coords.latitude,lng:(_location$coords=location.coords)==null?void 0:_location$coords.longitude};yield UserController.updateUser(profile.id,data,function(error){toast.show({render:function render(){return _jsx(ToastDialog,{message:error});}});});});return function updateGeoLocation(_x){return _ref.apply(this,arguments);};}();useCurrentLocation(updateGeoLocation,function(error){toast.show({render:function render(){return _jsx(ToastDialog,{message:error});}});});var screen=_jsx(LoadingOverlay,{});if(authStatus===\"loading\"||profileLoading){screen=_jsx(LoadingOverlay,{});}else if(authStatus===\"unauthenticated\"){screen=_jsx(Register,{});}else if(authStatus===\"authenticated\"&&!profile){screen=_jsx(SetupScreen,{});}else{screen=_jsx(UserContext.Provider,{value:{profile:profile,authUser:authUser,setProfile:setProfile},children:_jsx(SafeAreaProvider,{children:_jsx(MainNavigationStack,{})})});}return _jsx(NativeBaseProvider,{theme:theme,children:_jsxs(_StyledComponent,{source:Images.background,className:\"h-screen\",resizeMode:\"cover\",component:ImageBackground,children:[_jsx(StatusBar,{hidden:true}),screen]})});}_NativeWindStyleSheet.create({styles:{\"h-screen\":{\"height\":100}},topics:{\"h-screen\":[\"height\"]},units:{\"h-screen\":{\"height\":\"vh\"}}});","map":{"version":3,"names":["SafeAreaProvider","Register","StatusBar","LoadingOverlay","useProfile","UserContext","theme","NativeBaseProvider","Images","MainNavigationStack","SetupScreen","useToast","ToastDialog","UserController","useCurrentLocation","App","toast","error","show","render","authUser","user","profile","userProfile","setProfile","setUserProfile","authStatus","status","profileLoading","updateGeoLocation","location","data","lat","coords","latitude","lng","longitude","updateUser","id","screen","background"],"sources":["/Users/sonminhnguyen/Documents/programming/react-native/school/astro_magnet_initial/astro_magnet/App.tsx"],"sourcesContent":["import { SafeAreaProvider } from 'react-native-safe-area-context';\nimport Register from './src/frontend/screens/auth/login';\nimport { StatusBar } from 'expo-status-bar';\nimport LoadingOverlay from \"./src/frontend/components/LoadingOverlay\";\nimport useProfile from '@app/hooks/useProfile';\nimport { UserContext } from '@app/context/user';\nimport theme from '@app/theme/nativebase';\nimport { NativeBaseProvider } from \"native-base\";\nimport Images from '@app/theme/images';\nimport { ImageBackground } from 'react-native';\nimport MainNavigationStack from \"@app/frontend/navigation/main\";\nimport SetupScreen from '@app/frontend/screens/auth/setup';\nimport { useToast } from 'native-base';\nimport ToastDialog from '@app/frontend/components/global/toast';\nimport UserController from '@app/controller/user';\nimport useCurrentLocation from '@app/hooks/useCurrentLocation';\n\nexport default function App() {\n    const toast = useToast();\n    const { user: authUser, \n            userProfile: profile, \n            setUserProfile: setProfile, \n            status: authStatus, profileLoading } = useProfile((error)=> {\n                toast.show({\n                    render: () => <ToastDialog message={error} />\n                });\n            });\n\n    const updateGeoLocation = async (location: any) => {\n        if (!profile) return;\n        const data = {\n            lat: location.coords.latitude,\n            lng: location.coords?.longitude\n        };\n        await UserController.updateUser(profile.id!, data, (error)=> {\n            toast.show({\n                render: () => <ToastDialog message={error} />\n            })\n        });\n    }\n\n    useCurrentLocation(\n        updateGeoLocation,\n        (error)=> {\n            toast.show({\n                render: () => <ToastDialog message={error} />\n            })\n        },\n    )\n\n    let screen = <LoadingOverlay/>;\n\n    if (authStatus === \"loading\" || profileLoading) {\n        screen = <LoadingOverlay/>\n    } else if (authStatus === \"unauthenticated\") {\n        screen = <Register/>\n    } else if (authStatus === \"authenticated\" && !profile) {\n        screen = <SetupScreen/>\n    } else {\n        screen = (\n            <UserContext.Provider value={{ profile, authUser, setProfile }}>\n                    <SafeAreaProvider>\n                        <MainNavigationStack/>\n                    </SafeAreaProvider>\n            </UserContext.Provider>\n        )\n    }\n\n    return (\n        <NativeBaseProvider theme={theme}>\n            <ImageBackground\n                source={Images.background}\n                className=\"h-screen\"\n                resizeMode=\"cover\"\n            >\n                <StatusBar hidden/>\n                {screen}\n            </ImageBackground>\n        </NativeBaseProvider>\n    )\n}\n\n"],"mappings":"yMAAA,OAASA,gBAAgB,KAAQ,gCAAgC,CACjE,MAAOC,SAAQ,yCACf,OAASC,SAAS,KAAQ,iBAAiB,CAC3C,MAAOC,eAAc,gDACrB,MAAOC,WAAU,8BACjB,OAASC,WAAW,0BACpB,MAAOC,MAAK,8BACZ,OAASC,kBAAkB,KAAQ,aAAa,CAChD,MAAOC,OAAM,0BAA0B,2EAEvC,MAAOC,oBAAmB,sCAC1B,MAAOC,YAAW,yCAClB,OAASC,QAAQ,KAAQ,aAAa,CACtC,MAAOC,YAAW,8CAClB,MAAOC,eAAc,6BACrB,MAAOC,mBAAkB,sCAAsC,wFAE/D,cAAe,SAASC,IAAG,EAAG,CAC1B,GAAMC,MAAK,CAAGL,QAAQ,EAAE,CACxB,gBAG+CP,UAAU,CAAC,SAACa,KAAK,CAAI,CACxDD,KAAK,CAACE,IAAI,CAAC,CACPC,MAAM,CAAE,wBAAM,MAAC,WAAW,EAAC,OAAO,CAAEF,KAAM,EAAG,EACjD,CAAC,CAAC,CACN,CAAC,CAAC,CAPIG,QAAQ,aAAdC,IAAI,CACSC,OAAO,aAApBC,WAAW,CACKC,UAAU,aAA1BC,cAAc,CACNC,UAAU,aAAlBC,MAAM,CAAcC,cAAc,aAAdA,cAAc,CAM1C,GAAMC,kBAAiB,uCAAG,UAAOC,QAAa,CAAK,sBAC/C,GAAI,CAACR,OAAO,CAAE,OACd,GAAMS,KAAI,CAAG,CACTC,GAAG,CAAEF,QAAQ,CAACG,MAAM,CAACC,QAAQ,CAC7BC,GAAG,mBAAEL,QAAQ,CAACG,MAAM,eAAf,iBAAiBG,SAC1B,CAAC,CACD,KAAMvB,eAAc,CAACwB,UAAU,CAACf,OAAO,CAACgB,EAAE,CAAGP,IAAI,CAAE,SAACd,KAAK,CAAI,CACzDD,KAAK,CAACE,IAAI,CAAC,CACPC,MAAM,CAAE,wBAAM,MAAC,WAAW,EAAC,OAAO,CAAEF,KAAM,EAAG,EACjD,CAAC,CAAC,CACN,CAAC,CAAC,CACN,CAAC,iBAXKY,kBAAiB,4CAWtB,CAEDf,kBAAkB,CACde,iBAAiB,CACjB,SAACZ,KAAK,CAAI,CACND,KAAK,CAACE,IAAI,CAAC,CACPC,MAAM,CAAE,wBAAM,MAAC,WAAW,EAAC,OAAO,CAAEF,KAAM,EAAG,EACjD,CAAC,CAAC,CACN,CAAC,CACJ,CAED,GAAIsB,OAAM,CAAG,KAAC,cAAc,IAAE,CAE9B,GAAIb,UAAU,GAAK,SAAS,EAAIE,cAAc,CAAE,CAC5CW,MAAM,CAAG,KAAC,cAAc,IAAE,CAC9B,CAAC,IAAM,IAAIb,UAAU,GAAK,iBAAiB,CAAE,CACzCa,MAAM,CAAG,KAAC,QAAQ,IAAE,CACxB,CAAC,IAAM,IAAIb,UAAU,GAAK,eAAe,EAAI,CAACJ,OAAO,CAAE,CACnDiB,MAAM,CAAG,KAAC,WAAW,IAAE,CAC3B,CAAC,IAAM,CACHA,MAAM,CACF,KAAC,WAAW,CAAC,QAAQ,EAAC,KAAK,CAAE,CAAEjB,OAAO,CAAPA,OAAO,CAAEF,QAAQ,CAARA,QAAQ,CAAEI,UAAU,CAAVA,UAAW,CAAE,UACvD,KAAC,gBAAgB,WACb,KAAC,mBAAmB,IAAE,EACP,EAE9B,CACL,CAEA,MACI,MAAC,kBAAkB,EAAC,KAAK,CAAElB,KAAM,kCAEzB,MAAM,CAAEE,MAAM,CAACgC,UAAW,CAC1B,SAAS,CAAC,UAAU,CACpB,UAAU,CAAC,OAAO,qCAElB,KAAC,SAAS,EAAC,MAAM,OAAE,CAClBD,MAAM,KAEM,CAE7B,CAAC"},"metadata":{},"sourceType":"module"}