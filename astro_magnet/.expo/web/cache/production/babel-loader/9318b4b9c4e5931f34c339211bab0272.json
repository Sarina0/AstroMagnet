{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{isNull,isObject,isString}from'@react-native-firebase/app/lib/common';import{NativeFirebaseError}from'@react-native-firebase/app/lib/internal';var SETTABLE_FIELDS=['cacheControl','contentDisposition','contentEncoding','contentLanguage','contentType','customMetadata','md5hash'];export function handleStorageEvent(_x,_x2){return _handleStorageEvent.apply(this,arguments);}function _handleStorageEvent(){_handleStorageEvent=_asyncToGenerator(function*(storageInstance,event){var taskId=event.taskId,eventName=event.eventName;var body=event.body||{};if(body.error){body.error=yield NativeFirebaseError.fromEvent(body.error,storageInstance._config.namespace);}storageInstance.emitter.emit(storageInstance.eventNameForApp(taskId,eventName),body);});return _handleStorageEvent.apply(this,arguments);}export function getHttpUrlParts(url){var decoded=decodeURIComponent(url);var parts=decoded.match(/\\/b\\/(.*)\\/o\\/([a-zA-Z0-9./\\-_]+)(.*)/);if(!parts||parts.length<3){return null;}return{bucket:\"gs://\"+parts[1],path:parts[2]};}export function getGsUrlParts(url){var bucket=url.substring(0,url.indexOf('/',5))||url;var path=(url.indexOf('/',5)>-1?url.substring(url.indexOf('/',5)+1,url.length):'/')||'/';return{bucket:bucket,path:path};}export function validateMetadata(metadata){var update=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(!isObject(metadata)){throw new Error('firebase.storage.SettableMetadata must be an object value if provided.');}var metadataEntries=Object.entries(metadata);for(var i=0;i<metadataEntries.length;i++){var _metadataEntries$i=_slicedToArray(metadataEntries[i],2),key=_metadataEntries$i[0],value=_metadataEntries$i[1];if(!SETTABLE_FIELDS.includes(key)){throw new Error(\"firebase.storage.SettableMetadata unknown property '\"+key+\"' provided for metadata.\");}if(key==='md5hash'&&update===true){throw new Error(\"firebase.storage.SettableMetadata md5hash may only be set on upload, not on updateMetadata\");}if(key!=='customMetadata'){if(!isString(value)&&!isNull(value)){throw new Error(\"firebase.storage.SettableMetadata invalid property '\"+key+\"' should be a string or null value.\");}}else if(!isObject(value)&&!isNull(value)){throw new Error('firebase.storage.SettableMetadata.customMetadata must be an object of keys and string values or null value.');}}return metadata;}","map":{"version":3,"names":["isNull","isObject","isString","NativeFirebaseError","SETTABLE_FIELDS","handleStorageEvent","storageInstance","event","taskId","eventName","body","error","fromEvent","_config","namespace","emitter","emit","eventNameForApp","getHttpUrlParts","url","decoded","decodeURIComponent","parts","match","length","bucket","path","getGsUrlParts","substring","indexOf","validateMetadata","metadata","update","Error","metadataEntries","Object","entries","i","key","value","includes"],"sources":["/Users/sonminhnguyen/Documents/programming/react-native/school/astro_magnet_initial/astro_magnet/node_modules/@react-native-firebase/storage/lib/utils.js"],"sourcesContent":["/*\n * Copyright (c) 2016-present Invertase Limited & Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this library except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\nimport { isNull, isObject, isString } from '@react-native-firebase/app/lib/common';\nimport { NativeFirebaseError } from '@react-native-firebase/app/lib/internal';\n\nconst SETTABLE_FIELDS = [\n  'cacheControl',\n  'contentDisposition',\n  'contentEncoding',\n  'contentLanguage',\n  'contentType',\n  'customMetadata',\n  'md5hash',\n];\n\nexport async function handleStorageEvent(storageInstance, event) {\n  const { taskId, eventName } = event;\n  const body = event.body || {};\n\n  if (body.error) {\n    body.error = await NativeFirebaseError.fromEvent(body.error, storageInstance._config.namespace);\n  }\n\n  storageInstance.emitter.emit(storageInstance.eventNameForApp(taskId, eventName), body);\n}\n\nexport function getHttpUrlParts(url) {\n  const decoded = decodeURIComponent(url);\n  const parts = decoded.match(/\\/b\\/(.*)\\/o\\/([a-zA-Z0-9./\\-_]+)(.*)/);\n\n  if (!parts || parts.length < 3) {\n    return null;\n  }\n\n  return { bucket: `gs://${parts[1]}`, path: parts[2] };\n}\n\nexport function getGsUrlParts(url) {\n  const bucket = url.substring(0, url.indexOf('/', 5)) || url;\n  const path =\n    (url.indexOf('/', 5) > -1 ? url.substring(url.indexOf('/', 5) + 1, url.length) : '/') || '/';\n\n  return { bucket, path };\n}\n\nexport function validateMetadata(metadata, update = true) {\n  if (!isObject(metadata)) {\n    throw new Error('firebase.storage.SettableMetadata must be an object value if provided.');\n  }\n\n  const metadataEntries = Object.entries(metadata);\n\n  for (let i = 0; i < metadataEntries.length; i++) {\n    const [key, value] = metadataEntries[i];\n    // validate keys\n    if (!SETTABLE_FIELDS.includes(key)) {\n      throw new Error(\n        `firebase.storage.SettableMetadata unknown property '${key}' provided for metadata.`,\n      );\n    }\n\n    // md5 is only allowed on put, not on update\n    if (key === 'md5hash' && update === true) {\n      throw new Error(\n        `firebase.storage.SettableMetadata md5hash may only be set on upload, not on updateMetadata`,\n      );\n    }\n\n    // validate values\n    if (key !== 'customMetadata') {\n      if (!isString(value) && !isNull(value)) {\n        throw new Error(\n          `firebase.storage.SettableMetadata invalid property '${key}' should be a string or null value.`,\n        );\n      }\n    } else if (!isObject(value) && !isNull(value)) {\n      throw new Error(\n        'firebase.storage.SettableMetadata.customMetadata must be an object of keys and string values or null value.',\n      );\n    }\n  }\n\n  return metadata;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}