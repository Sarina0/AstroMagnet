{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import{useState,useEffect,useContext}from\"react\";import*as Location from\"expo-location\";import{UserContext}from\"../context/user\";export default function useCurrentLocation(onReceivedLocation,onError){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),location=_useState2[0],setLocation=_useState2[1];var _useContext=useContext(UserContext),profile=_useContext.profile;useEffect(function(){if(!profile)return;_asyncToGenerator(function*(){try{var _yield$Location$reque=yield Location.requestForegroundPermissionsAsync(),status=_yield$Location$reque.status;if(status!=='granted'){throw new Error('Permission denied');}var _location=yield Location.getCurrentPositionAsync({});onReceivedLocation&&onReceivedLocation(_location);setLocation(_location);}catch(error){if(error.message==='Permission denied'){onError&&onError(\"Please allow location acess so we can find you a match. Your data is safe with us!\");return;}onError&&onError(\"Error gettting current location\");console.log(\"[LOG] get location error\",error);}})();},[profile]);return location;}","map":{"version":3,"names":["useState","useEffect","useContext","Location","UserContext","useCurrentLocation","onReceivedLocation","onError","location","setLocation","profile","requestForegroundPermissionsAsync","status","Error","getCurrentPositionAsync","error","message","console","log"],"sources":["/Users/sonminhnguyen/Documents/programming/react-native/school/astro_magnet_initial/astro_magnet/src/hooks/useCurrentLocation.tsx"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\nimport * as Location from \"expo-location\";\nimport { UserContext } from \"@app/context/user\"   \n\n/**\n * hook to get current location\n * @param onReceivedLocation callback function to handle location\n * @param onError callback function to handle error\n * @returns {Location.LocationData | null} location - current location\n */\nexport default function useCurrentLocation(\n    onReceivedLocation?: (location: Location.LocationObject) => void,\n    onError?: (error: string) => void\n) {\n    const [location, setLocation] = useState<Location.LocationObject | null>(null);\n    const { profile } = useContext(UserContext);\n\n    useEffect(() => {\n        if (!profile) return;\n        (async () => {\n            try {\n                let { status } = await Location.requestForegroundPermissionsAsync();\n                if (status !== 'granted') {\n                    throw new Error('Permission denied');\n                }\n                let location = await Location.getCurrentPositionAsync({});\n                onReceivedLocation && onReceivedLocation(location);\n                setLocation(location);\n            } catch (error: any) {\n                if (error.message === 'Permission denied') {\n                    onError && onError(\"Please allow location acess so we can find you a match. Your data is safe with us!\");\n                    return;\n                }\n                onError && onError(\"Error gettting current location\");\n                console.log(\"[LOG] get location error\", error);\n            }\n        })();\n    }, [profile]);\n    return location;\n}"],"mappings":"wIAAA,OAASA,QAAQ,CAAEC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CACvD,MAAO,GAAKC,SAAQ,KAAM,eAAe,CACzC,OAASC,WAAW,uBAQpB,cAAe,SAASC,mBAAkB,CACtCC,kBAAgE,CAChEC,OAAiC,CACnC,CACE,cAAgCP,QAAQ,CAAiC,IAAI,CAAC,wCAAvEQ,QAAQ,eAAEC,WAAW,eAC5B,gBAAoBP,UAAU,CAACE,WAAW,CAAC,CAAnCM,OAAO,aAAPA,OAAO,CAEfT,SAAS,CAAC,UAAM,CACZ,GAAI,CAACS,OAAO,CAAE,OACd,kBAAC,WAAY,CACT,GAAI,CACA,+BAAuBP,SAAQ,CAACQ,iCAAiC,EAAE,CAA7DC,MAAM,uBAANA,MAAM,CACZ,GAAIA,MAAM,GAAK,SAAS,CAAE,CACtB,KAAM,IAAIC,MAAK,CAAC,mBAAmB,CAAC,CACxC,CACA,GAAIL,UAAQ,MAASL,SAAQ,CAACW,uBAAuB,CAAC,CAAC,CAAC,CAAC,CACzDR,kBAAkB,EAAIA,kBAAkB,CAACE,SAAQ,CAAC,CAClDC,WAAW,CAACD,SAAQ,CAAC,CACzB,CAAE,MAAOO,KAAU,CAAE,CACjB,GAAIA,KAAK,CAACC,OAAO,GAAK,mBAAmB,CAAE,CACvCT,OAAO,EAAIA,OAAO,CAAC,oFAAoF,CAAC,CACxG,OACJ,CACAA,OAAO,EAAIA,OAAO,CAAC,iCAAiC,CAAC,CACrDU,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEH,KAAK,CAAC,CAClD,CACJ,CAAC,GAAG,CACR,CAAC,CAAE,CAACL,OAAO,CAAC,CAAC,CACb,MAAOF,SAAQ,CACnB"},"metadata":{},"sourceType":"module"}