{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import Platform from\"react-native-web/dist/exports/Platform\";import storage from'@react-native-firebase/storage';export var UploadController=function(){function UploadController(){_classCallCheck(this,UploadController);throw new Error(\"UploadController is a static class\");}_createClass(UploadController,null,[{key:\"uploadImage\",value:function(){var _uploadImage=_asyncToGenerator(function*(image){var fileName=image.name;var fileUri=image.uri;if(!fileName){var randomText='';var characters='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';var charactersLength=characters.length;for(var i=0;i<20;i++){randomText+=characters.charAt(Math.floor(Math.random()*charactersLength));}fileName=randomText+'.jpg';}if(Platform.OS==='ios'){if(fileUri.indexOf('file://')===0){fileUri=fileUri.replace('file://','');}}else{if(fileUri.indexOf('://')<0){fileUri='file://'+fileUri;}}var eventReference=storage().ref(fileName);yield eventReference.putFile(fileUri);var uploadedImage=yield storage().ref('/'+fileName).getDownloadURL().catch(function(error){console.log(\"[LOG] error:\",error);throw new Error(error.message);});return uploadedImage;});function uploadImage(_x){return _uploadImage.apply(this,arguments);}return uploadImage;}()}]);return UploadController;}();","map":{"version":3,"names":["storage","UploadController","Error","image","fileName","name","fileUri","uri","randomText","characters","charactersLength","length","i","charAt","Math","floor","random","Platform","OS","indexOf","replace","eventReference","ref","putFile","uploadedImage","getDownloadURL","catch","error","console","log","message"],"sources":["/Users/sonminhnguyen/Documents/programming/react-native/school/astro_magnet_initial/astro_magnet/src/controller/upload/index.tsx"],"sourcesContent":["import {Platform} from 'react-native'\nimport storage from '@react-native-firebase/storage';\n\n\n/**\n * Upload controller to handle upload\n */\nexport class UploadController {\n\n    constructor() {\n        throw new Error(\"UploadController is a static class\");\n    }\n\n    /**\n     * upload image to firebase storage\n     * @returns returns user info\n     */\n    static async uploadImage(image: {\n        uri: string\n        name?: string\n    }): Promise<string> {\n\n        //get image name\n        let fileName = image.name;\n\n        //get image uri\n        let fileUri = image.uri;\n\n        //if image name is not provided\n        if (!fileName) {\n\n            //generate random image name\n            let randomText = '';\n            var characters =\n                'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n            var charactersLength = characters.length;\n            for (var i = 0; i < 20; i++) {\n                randomText += characters.charAt(Math.floor(Math.random() * charactersLength));\n            }\n            fileName = randomText + '.jpg';\n        }\n        \n\n        if (Platform.OS === 'ios') {\n            if (fileUri.indexOf('file://') === 0) {\n                fileUri = fileUri.replace('file://', '');\n            }\n        } else {\n            if (fileUri.indexOf('://') < 0) {\n                fileUri = 'file://' + fileUri;\n            }\n        }\n\n        const eventReference = storage().ref(fileName);\n        await eventReference.putFile(fileUri);\n        const uploadedImage = await storage()\n            .ref('/' + fileName)\n            .getDownloadURL()\n            .catch((error) => {\n                console.log(\"[LOG] error:\", error)\n                throw new Error(error.message)\n            })\n        return uploadedImage;\n    }\n}\n\n"],"mappings":"oQACA,MAAOA,QAAO,KAAM,gCAAgC,CAMpD,UAAaC,iBAAgB,YAEzB,2BAAc,wCACV,KAAM,IAAIC,MAAK,CAAC,oCAAoC,CAAC,CACzD,CAAC,2GAMD,UAAyBC,KAGxB,CAAmB,CAGhB,GAAIC,SAAQ,CAAGD,KAAK,CAACE,IAAI,CAGzB,GAAIC,QAAO,CAAGH,KAAK,CAACI,GAAG,CAGvB,GAAI,CAACH,QAAQ,CAAE,CAGX,GAAII,WAAU,CAAG,EAAE,CACnB,GAAIC,WAAU,CACV,gEAAgE,CACpE,GAAIC,iBAAgB,CAAGD,UAAU,CAACE,MAAM,CACxC,IAAK,GAAIC,EAAC,CAAG,CAAC,CAAEA,CAAC,CAAG,EAAE,CAAEA,CAAC,EAAE,CAAE,CACzBJ,UAAU,EAAIC,UAAU,CAACI,MAAM,CAACC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,CAAGN,gBAAgB,CAAC,CAAC,CACjF,CACAN,QAAQ,CAAGI,UAAU,CAAG,MAAM,CAClC,CAGA,GAAIS,QAAQ,CAACC,EAAE,GAAK,KAAK,CAAE,CACvB,GAAIZ,OAAO,CAACa,OAAO,CAAC,SAAS,CAAC,GAAK,CAAC,CAAE,CAClCb,OAAO,CAAGA,OAAO,CAACc,OAAO,CAAC,SAAS,CAAE,EAAE,CAAC,CAC5C,CACJ,CAAC,IAAM,CACH,GAAId,OAAO,CAACa,OAAO,CAAC,KAAK,CAAC,CAAG,CAAC,CAAE,CAC5Bb,OAAO,CAAG,SAAS,CAAGA,OAAO,CACjC,CACJ,CAEA,GAAMe,eAAc,CAAGrB,OAAO,EAAE,CAACsB,GAAG,CAAClB,QAAQ,CAAC,CAC9C,KAAMiB,eAAc,CAACE,OAAO,CAACjB,OAAO,CAAC,CACrC,GAAMkB,cAAa,MAASxB,QAAO,EAAE,CAChCsB,GAAG,CAAC,GAAG,CAAGlB,QAAQ,CAAC,CACnBqB,cAAc,EAAE,CAChBC,KAAK,CAAC,SAACC,KAAK,CAAK,CACdC,OAAO,CAACC,GAAG,CAAC,cAAc,CAAEF,KAAK,CAAC,CAClC,KAAM,IAAIzB,MAAK,CAACyB,KAAK,CAACG,OAAO,CAAC,CAClC,CAAC,CAAC,CACN,MAAON,cAAa,CACxB,CAAC"},"metadata":{},"sourceType":"module"}