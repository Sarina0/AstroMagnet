{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport { useState, useEffect, useContext } from \"react\";\nimport firestore from \"@react-native-firebase/firestore\";\nimport { UserContext } from \"../context/user\";\nexport default function useLiked(onError) {\n  var _useContext = useContext(UserContext),\n    profile = _useContext.profile;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    likedUsers = _useState2[0],\n    setLiked = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  useEffect(function () {\n    if (!profile) {\n      setLoading(false);\n      return;\n    }\n    if ((profile == null ? void 0 : profile.liked.length) === 0) {\n      setLiked([]);\n      setLoading(false);\n      return;\n    }\n    var unsubscribe = firestore().collection(\"users\").where(firestore.FieldPath.documentId(), \"in\", profile.liked).onSnapshot(function (querySnapshot) {\n      var list = [];\n      querySnapshot.forEach(function (doc) {\n        list.push(_objectSpread({\n          id: doc.id\n        }, doc.data()));\n      });\n      setLiked(list);\n      setLoading(false);\n    }, function (error) {\n      setLoading(false);\n      onError && onError(\"Error fetching liked users\");\n      console.log(\"[LOG] error fetching liked users:\", error);\n    });\n    return unsubscribe;\n  }, [profile]);\n  return {\n    likedUsers: likedUsers,\n    loading: loading\n  };\n}","map":{"version":3,"names":["useState","useEffect","useContext","firestore","UserContext","useLiked","onError","profile","likedUsers","setLiked","loading","setLoading","liked","length","unsubscribe","collection","where","FieldPath","documentId","onSnapshot","querySnapshot","list","forEach","doc","push","id","data","error","console","log"],"sources":["/Users/sonminhnguyen/Documents/programming/react-native/school/astro_magnet_initial/astro_magnet/src/hooks/useLiked.tsx"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\nimport firestore from \"@react-native-firebase/firestore\";\nimport { FireDoc } from \"@app/shared/interfaces/firebase\";\nimport { UserContext } from \"@app/context/user\";\nimport {User} from \"@app/shared/interfaces/user\";\n\n/**\n * - This hooks load all users that current logged-in user liked.\n * - Return an object with a list of likedUsers and loading state\n * @param {(error: string)=>void | undefined} onError - callback function to handle network error\n * @return {User[]} likedUsers - a list of users that current logged-in user liked\n * @return {boolean} loading - fetch loading state\n */\nexport default function useLiked(\n    onError?:(error:string)=>void\n) {\n    const { profile } = useContext(UserContext);\n    const [likedUsers, setLiked] = useState<User[]>([]);\n    const [loading, setLoading] = useState<boolean>(true);\n    useEffect(()=> {\n        if (!profile) { \n            setLoading(false);\n            return \n        }\n        if (profile?.liked.length === 0) {\n            setLiked([]);\n            setLoading(false);\n            return;\n        }\n        const unsubscribe = firestore()\n            .collection(\"users\")\n            .where(firestore.FieldPath.documentId(), \"in\", profile.liked)\n            .onSnapshot((querySnapshot) => {\n                const list: FireDoc[] = [];\n                querySnapshot.forEach((doc) => {\n                    list.push({\n                        id: doc.id,\n                        ...doc.data(),\n                    });\n                });\n                setLiked(list as User[]);\n                setLoading(false);\n            }\n            , (error) => {\n                setLoading(false);\n                onError && onError(\"Error fetching liked users\");\n                console.log(\"[LOG] error fetching liked users:\", error);\n        });\n        return unsubscribe;\n    }, [profile]);\n\n    return {\n        likedUsers,\n        loading\n    }\n}"],"mappings":";;;;AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AACvD,OAAOC,SAAS,MAAM,kCAAkC;AAExD,SAASC,WAAW;AAUpB,eAAe,SAASC,QAAQ,CAC5BC,OAA6B,EAC/B;EACE,kBAAoBJ,UAAU,CAACE,WAAW,CAAC;IAAnCG,OAAO,eAAPA,OAAO;EACf,gBAA+BP,QAAQ,CAAS,EAAE,CAAC;IAAA;IAA5CQ,UAAU;IAAEC,QAAQ;EAC3B,iBAA8BT,QAAQ,CAAU,IAAI,CAAC;IAAA;IAA9CU,OAAO;IAAEC,UAAU;EAC1BV,SAAS,CAAC,YAAK;IACX,IAAI,CAACM,OAAO,EAAE;MACVI,UAAU,CAAC,KAAK,CAAC;MACjB;IACJ;IACA,IAAI,CAAAJ,OAAO,oBAAPA,OAAO,CAAEK,KAAK,CAACC,MAAM,MAAK,CAAC,EAAE;MAC7BJ,QAAQ,CAAC,EAAE,CAAC;MACZE,UAAU,CAAC,KAAK,CAAC;MACjB;IACJ;IACA,IAAMG,WAAW,GAAGX,SAAS,EAAE,CAC1BY,UAAU,CAAC,OAAO,CAAC,CACnBC,KAAK,CAACb,SAAS,CAACc,SAAS,CAACC,UAAU,EAAE,EAAE,IAAI,EAAEX,OAAO,CAACK,KAAK,CAAC,CAC5DO,UAAU,CAAC,UAACC,aAAa,EAAK;MAC3B,IAAMC,IAAe,GAAG,EAAE;MAC1BD,aAAa,CAACE,OAAO,CAAC,UAACC,GAAG,EAAK;QAC3BF,IAAI,CAACG,IAAI;UACLC,EAAE,EAAEF,GAAG,CAACE;QAAE,GACPF,GAAG,CAACG,IAAI,EAAE,EACf;MACN,CAAC,CAAC;MACFjB,QAAQ,CAACY,IAAI,CAAW;MACxBV,UAAU,CAAC,KAAK,CAAC;IACrB,CAAC,EACC,UAACgB,KAAK,EAAK;MACThB,UAAU,CAAC,KAAK,CAAC;MACjBL,OAAO,IAAIA,OAAO,CAAC,4BAA4B,CAAC;MAChDsB,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAEF,KAAK,CAAC;IAC/D,CAAC,CAAC;IACF,OAAOb,WAAW;EACtB,CAAC,EAAE,CAACP,OAAO,CAAC,CAAC;EAEb,OAAO;IACHC,UAAU,EAAVA,UAAU;IACVE,OAAO,EAAPA;EACJ,CAAC;AACL"},"metadata":{},"sourceType":"module"}