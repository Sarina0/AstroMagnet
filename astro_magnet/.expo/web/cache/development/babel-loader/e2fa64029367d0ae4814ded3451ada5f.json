{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { useState, useEffect, useContext } from \"react\";\nimport * as Location from \"expo-location\";\nimport { UserContext } from \"../context/user\";\nexport default function useCurrentLocation(onReceivedLocation, onError) {\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    location = _useState2[0],\n    setLocation = _useState2[1];\n  var _useContext = useContext(UserContext),\n    profile = _useContext.profile;\n  useEffect(function () {\n    if (!profile) return;\n    _asyncToGenerator(function* () {\n      try {\n        var _yield$Location$reque = yield Location.requestForegroundPermissionsAsync(),\n          status = _yield$Location$reque.status;\n        if (status !== 'granted') {\n          throw new Error('Permission denied');\n        }\n        var _location = yield Location.getCurrentPositionAsync({});\n        onReceivedLocation && onReceivedLocation(_location);\n        setLocation(_location);\n      } catch (error) {\n        if (error.message === 'Permission denied') {\n          onError && onError(\"Please allow location acess so we can find you a match. Your data is safe with us!\");\n          return;\n        }\n        onError && onError(\"Error gettting current location\");\n        console.log(\"[LOG] get location error\", error);\n      }\n    })();\n  }, [profile]);\n  return location;\n}","map":{"version":3,"names":["useState","useEffect","useContext","Location","UserContext","useCurrentLocation","onReceivedLocation","onError","location","setLocation","profile","requestForegroundPermissionsAsync","status","Error","getCurrentPositionAsync","error","message","console","log"],"sources":["/Users/sonminhnguyen/Documents/programming/react-native/school/astro_magnet_initial/astro_magnet/src/hooks/useCurrentLocation.tsx"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\nimport * as Location from \"expo-location\";\nimport { UserContext } from \"@app/context/user\"   \n\n/**\n * hook to get current location\n * @param onReceivedLocation callback function to handle location\n * @param onError callback function to handle error\n * @returns {Location.LocationData | null} location - current location\n */\nexport default function useCurrentLocation(\n    onReceivedLocation?: (location: Location.LocationObject) => void,\n    onError?: (error: string) => void\n) {\n    const [location, setLocation] = useState<Location.LocationObject | null>(null);\n    const { profile } = useContext(UserContext);\n\n    useEffect(() => {\n        if (!profile) return;\n        (async () => {\n            try {\n                let { status } = await Location.requestForegroundPermissionsAsync();\n                if (status !== 'granted') {\n                    throw new Error('Permission denied');\n                }\n                let location = await Location.getCurrentPositionAsync({});\n                onReceivedLocation && onReceivedLocation(location);\n                setLocation(location);\n            } catch (error: any) {\n                if (error.message === 'Permission denied') {\n                    onError && onError(\"Please allow location acess so we can find you a match. Your data is safe with us!\");\n                    return;\n                }\n                onError && onError(\"Error gettting current location\");\n                console.log(\"[LOG] get location error\", error);\n            }\n        })();\n    }, [profile]);\n    return location;\n}"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AACvD,OAAO,KAAKC,QAAQ,MAAM,eAAe;AACzC,SAASC,WAAW;AAQpB,eAAe,SAASC,kBAAkB,CACtCC,kBAAgE,EAChEC,OAAiC,EACnC;EACE,gBAAgCP,QAAQ,CAAiC,IAAI,CAAC;IAAA;IAAvEQ,QAAQ;IAAEC,WAAW;EAC5B,kBAAoBP,UAAU,CAACE,WAAW,CAAC;IAAnCM,OAAO,eAAPA,OAAO;EAEfT,SAAS,CAAC,YAAM;IACZ,IAAI,CAACS,OAAO,EAAE;IACd,kBAAC,aAAY;MACT,IAAI;QACA,kCAAuBP,QAAQ,CAACQ,iCAAiC,EAAE;UAA7DC,MAAM,yBAANA,MAAM;QACZ,IAAIA,MAAM,KAAK,SAAS,EAAE;UACtB,MAAM,IAAIC,KAAK,CAAC,mBAAmB,CAAC;QACxC;QACA,IAAIL,SAAQ,SAASL,QAAQ,CAACW,uBAAuB,CAAC,CAAC,CAAC,CAAC;QACzDR,kBAAkB,IAAIA,kBAAkB,CAACE,SAAQ,CAAC;QAClDC,WAAW,CAACD,SAAQ,CAAC;MACzB,CAAC,CAAC,OAAOO,KAAU,EAAE;QACjB,IAAIA,KAAK,CAACC,OAAO,KAAK,mBAAmB,EAAE;UACvCT,OAAO,IAAIA,OAAO,CAAC,oFAAoF,CAAC;UACxG;QACJ;QACAA,OAAO,IAAIA,OAAO,CAAC,iCAAiC,CAAC;QACrDU,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEH,KAAK,CAAC;MAClD;IACJ,CAAC,GAAG;EACR,CAAC,EAAE,CAACL,OAAO,CAAC,CAAC;EACb,OAAOF,QAAQ;AACnB"},"metadata":{},"sourceType":"module"}